CREATE TABLE NACAO (
  nome              VARCHAR(200)  NOT NULL,
  continente        VARCHAR(5)    NOT NULL,
  esporte_principal VARCHAR(50),
  bandeira          VARCHAR(80)   NOT NULL,
  hino              TEXT          NOT NULL,
  nro_atletas       INT           NOT NULL,
  PRIMARY KEY ( nome )
);

CREATE TABLE PARTICIPANTE(
  nro_passaporte    INTEGER(12)   NOT NULL,
  nacao             VARCHAR(200)  NOT NULL,
  data_nasc         DATE          NOT NULL,
  nome              VARCHAR(200)  NOT NULL,
  sexo              BOOLEAN       NOT NULL,

  FOREIGN KEY ( nacao ) REFERENCES  NACAO( nome ) ON DELETE CASCADE,
  PRIMARY KEY ( nro_passaporte )
);

CREATE TABLE PREPARADOR(
  nro_passaporte  INTEGER(12)     NOT NULL,
  estado          VARCHAR(2)      NOT NULL,
  cpf             INTEGER(15),
  email           VARCHAR(150)    NOT NULL,
  senha           VARCHAR(100)    NOT NULL,
  cidade          VARCHAR(150),

  FOREIGN KEY ( nro_passaporte ) REFERENCES PARTICIPANTE( nro_passaporte ) ON DELETE CASCADE,
  PRIMARY KEY ( nro_passaporte )
);

CREATE TABLE TELEFONE_PREPARADOR(
  preparador      INTEGER(12)     NOT NULL,
  telefone        INTEGER(15)     NOT NULL,

  FOREIGN KEY ( preparador ) REFERENCES PREPARADOR( nro_passaporte ) ON DELETE CASCADE,
  PRIMARY KEY ( preparador, telefone )
);

CREATE TABLE ROTINA(
  preparador      INTEGER(12)     NOT NULL,
  periodo         DATE            NOT NULL,
  descricao       TEXT            NOT NULL,

  FOREIGN KEY ( preparador ) REFERENCES PREPARADOR( nro_passaporte ) ON DELETE CASCADE,
  PRIMARY KEY ( preparador, periodo )
);

CREATE TABLE TREINO(
  id              INTEGER         NOT NULL AUTO_INCREMENT,
  objetivo        TEXT            NOT NULL,

  PRIMARY KEY ( id )
);

CREATE TABLE EXERCICIOS(
  treino          INTEGER         NOT NULL,
  exercicio       VARCHAR(40)     NOT NULL,

  FOREIGN KEY ( treino ) REFERENCES TREINO( id ) ON DELETE CASCADE,
  PRIMARY KEY ( treino, exercicio )
);

CREATE TABLE DIAS_TREINO(
  treino          INTEGER         NOT NULL,
  dia             DATE            NOT NULL,

  FOREIGN KEY ( treino ) REFERENCES TREINO( id ) ON DELETE CASCADE,
  PRIMARY KEY ( treino, dia )
);

CREATE TABLE PREPARACAO(
  id              INTEGER         NOT NULL AUTO_INCREMENT,
  dieta           TEXT            NOT NULL,
  hrs_de_sono     INTEGER(2)      NOT NULL,

  PRIMARY KEY ( id )
);

CREATE TABLE AQUECIMENTOS(
  preparacao      INTEGER         NOT NULL,
  aquecimento     VARCHAR(40)     NOT NULL,

  FOREIGN KEY ( preparacao ) REFERENCES PREPARACAO( id ),
  PRIMARY KEY ( preparacao, aquecimento )
);

CRETE TABLE PREP_TREINO(
  treino          INTEGER         NOT NULL,
  preparacao      INTEGER         NOT NULL,

  FOREIGN KEY ( treino ) REFERENCES TREINO( id ),
  FOREIGN KEY ( preparacao ) REFERENCES PREPARACAO( id ),

  PRIMARY KEY ( treino, preparacao )
);

CREATE TABLE RECUPERACAO(
  id              INTEGER         NOT NULL AUTO_INCREMENT,
  tempo_repouso   INTEGER(2)      NOT NULL,

  PRIMARY KEY ( id )
);

CREATE TABLE ALONGAMENTOS(
  recuperacao     INTEGER         NOT NULL,
  alongamento     VARCHAR(40)     NOT NULL,

  FOREIGN KEY ( recuperacao ) REFERENCES RECUPERACAO ( id ),

  PRIMARY KEY ( recuperacao, alongamento )
);

CREATE TABLE REC_TREINO(
  treino          INTEGER         NOT NULL AUTO_INCREMENT,
  preparacao      INTEGER         NOT NULL,

  FOREIGN KEY ( treino ) REFERENCES TREINO( id ),
  FOREIGN KEY ( preparacao ) REFERENCES PREPARACAO( id ),

  PRIMARY KEY ( treino, preparacao )
);

CREATE TABLE ATLETA(
  nro_passaporte  INTEGER(12)     NOT NULL,
  peso            INTEGER(3)      NOT NULL,
  altura          INTEGER(3)      NOT NULL,

  FOREIGN KEY ( nro_passaporte ) REFERENCES PARTICIPANTE( nro_passaporte ),

  PRIMARY KEY ( nro_passaporte )
);

CREATE TABLE SEGUE(
  atleta          INTEGER(12)     NOT NULL,
  preparador      INTEGER(12)     NOT NULL,
  periodo         DATE            NOT NULL,

  FOREIGN KEY ( preparador, periodo ) REFERENCES ROTINA( preparador, periodo ),
  PRIMARY KEY ( atleta, preparador, periodo )
);

CREATE TABLE MODALIDADE(
  cod_unico       INTEGER(4)      NOT NULL AUTO_INCREMENT,
  nome            VARCHAR(30)     NOT NULL,
  descricao       TEXT            NOT NULL,

  PRIMARY KEY ( cod_unico )
);

CREATE TABLE COMPETE(
  atleta          INTEGER(12)     NOT NULL,
  modalidade      INTEGER(4)      NOT NULL,

  FOREIGN KEY ( atleta )  REFERENCES ATLETA( nro_passaporte ),
  FOREIGN KEY ( modalidade ) REFERENCES MODALIDADE( cod_unico ),

  PRIMARY KEY ( atleta, modalidade )
);

CREATE TABLE LESAO(
  id              INTEGER(4)      NOT NULL AUTO_INCREMENT,
  descricao       TEXT            NOT NULL,

  PRIMARY KEY ( id )
);

CREATE TABLE MEDICO(
  nome            VARCHAR(150)    NOT NULL,
  crm             VARCHAR(12)     NOT NULL,
  doc_identidade  INTEGER(12)     NOT NULL UNIQUE,
  endereco        VARCHAR(200)    NOT NULL,

  PRIMARY KEY ( doc_identidade )
);

CREATE TABLE TELEFONE_MEDICO(
  medico          VARCHAR(12)     NOT NULL,
  telefone        INTEGER(15)     NOT NULL,

  FOREIGN KEY ( medico ) REFERENCES MEDICO( crm );
  PRIMARY KEY ( medico, telefone )
);

CREATE TABLE DIAGNOSTICO(
  id              INTEGER(4)      NOT NULL AUTO_INCREMENT,
  descricao       TEXT            NOT NULL,

  PRIMARY KEY ( id )
);

CREATE TABLE METODO_DE_TRATAMENTO(
  id              INTEGER(4)      NOT NULL AUTO_INCREMENT,
  diagnostico     INTEGER(4)      NOT NULL,
  descricao       TEXT            NOT NULL,
  efetividade     REAL,

  FOREIGN KEY ( diagnostico ) REFERENCES DIAGNOSTICO( id ),

  PRIMARY KEY ( id )
);



CREATE TABLE ACOMPANHA(
    medico      VARCHAR(12)     NOT NULL,
    atleta      INTEGER(12)     NOT NULL,
    lesao       INTEGER(4)      NOT NULL,
    
    
    PRIMARY KEY (medico, atleta, lesao),
    FOREIGN KEY ( medico ) REFERENCES MEDICO ( crm ) ON DELETE CASCADE, 
    FOREIGN KEY ( atleta ) REFERENCES ATLETA ( nro_passaporte ) ON DELETE CASCADE,
    FOREIGN KEY ( lesao ) REFERENCES LESAO ( id ) ON DELETE CASCADE 
);


CREATE TABLE DOPING(
    medico      VARCHAR(12)     NOT NULL,
    atleta      INTEGER(12)     NOT NULL,
    modalidade  INTEGER(4)      NOT NULL,
    data        DATE            NOT NULL,
    resultado   BOOLEAN         NOT NULL,   
    
    PRIMARY KEY ( medico, atleta, modalidade ),
    FOREIGN KEY ( modalidade ) REFERENCES MODALIDADE ( cod_unico ) ON DELETE CASCADE, 
    FOREIGN KEY ( medico ) REFERENCES MEDICO ( crm ) ON DELETE CASCADE, 
    FOREIGN KEY ( atleta ) REFERENCES ATLETA ( nro_passaporte ) ON DELETE CASCADE 
);

CREATE TABLE CONSULTA(
    medico      VARCHAR(12)     NOT NULL,
    paciente    INTEGER(12)     NOT NULL,
    data        DATE            NOT NULL,
    diagnostico INTEGER(4)      NOT NULL,


    PRIMARY KEY ( medico, paciente, data ),
    FOREIGN KEY ( medico ) REFERENCES MEDICO ( crm ) ON DELETE CASCADE, 
    FOREIGN KEY ( atleta ) REFERENCES ATLETA ( nro_passaporte ) ON DELETE CASCADE 
    FOREIGN KEY ( diagnostico ) REFERENCES DIAGNOSTICO( id ) ON DELETE CASCADE.
);

CREATE TABLE SINTOMAS(
    medico      VARCHAR(12)     NOT NULL,
    atleta      INTEGER(12)     NOT NULL,
    data        DATE            NOT NULL,
    sintoma    TEXT            NOT NULL,

    PRIMARY KEY ( medico, atleta, sintoma ),
    FOREIGN KEY ( medico, atleta, data ) REFERENCES CONSULTA ( medico, paciente,
    data ) ON DELETE CASCADE,
);
